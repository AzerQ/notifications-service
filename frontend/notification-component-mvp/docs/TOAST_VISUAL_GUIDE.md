# ?? Toast Notifications - Визуальное руководство

## Оглавление
- [Обзор](#обзор)
- [Одиночный Toast](#одиночный-toast)
- [Стек Toast](#стек-toast)
- [Анимации](#анимации)
- [Примеры кода](#примеры-кода)
- [Best Practices](#best-practices)

---

## Обзор

Toast уведомления - это всплывающие карточки, которые появляются в правом верхнем углу экрана при получении новых уведомлений через SignalR.

### Ключевые особенности:
- ? Автоматическое появление при новых уведомлениях
- ? Прогресс-бар с визуальным таймером
- ? Умное отображение (не показываются при открытом dropdown)
- ? Поддержка множественных toast в столбик
- ? Плавные анимации и hover эффекты
- ? Responsive дизайн
- ? Dark mode

---

## Одиночный Toast

### Структура

```
???????????????????????????????????????????
? ????????? ??????????????     ??? ? ? Header
? ? Task  ? ?Task Assigned?           ?X? ?
? ????????? ??????????????      ??? ?
?           ?
? New Task Assigned to You    ? ? Title (bold, 2 lines)
?          ?
? Deploy new feature to production        ? ? Content (3 lines)
? before end of sprint. High priority     ?
? task with...  ?
?        ?
? John Doe  Click to view ?   ? ? Footer: Author + URL
?   ?
? #task #urgent #deploy         ? ? Hashtags (max 3)
?             ?
???????????????????????????????????????????
? ????????????????????????????????????   ? ? Progress bar
???????????????????????????????????????????
  ?       ?
  Появляется         Исчезает через 5 сек
```

### Компоненты

#### 1. Header
- **Type Badge** (синий): `[Task]`
- **Subtype Badge** (фиолетовый): `[Task Assigned]`
- **Close Button**: `[X]`

#### 2. Body
- **Title**: Жирный шрифт, max 2 строки
- **Content**: Обычный шрифт, max 3 строки

#### 3. Footer
- **Author**: Имя отправителя (если есть)
- **URL Indicator**: "Click to view ?" (если есть URL)

#### 4. Hashtags
- Отображаются до 3 тегов
- Серый фон с округлыми углами
- Формат: `#tag`

#### 5. Progress Bar
- Синяя полоса внизу
- Уменьшается от 100% до 0% за 5 секунд
- Визуальный индикатор времени до закрытия

---

## Стек Toast

### Вертикальное расположение

```
           Right Edge
   ?
   ???????????????????????????????  ?
 ?  Toast #1 (newest)  ?  ? ? z-index: 100
   ?  Just received (5s left)    ?  ?
   ???????????????????????????????  ?
  ? 0.75rem gap         ?
   ???????????????????????????????  ?
   ?  Toast #2         ?  ? ? z-index: 99
   ?  2 seconds ago (3s left)?  ?
   ???????????????????????????????  ?
  ? 0.75rem gap        ?
   ???????????????????????????????  ?
   ?  Toast #3           ?  ? ? z-index: 98
   ?  4 seconds ago (1s left)    ??
   ???????????????????????????????  ?
 ? 0.75rem gap        ?
   ???????????????????????????????  ?
 ?  Toast #4 (oldest) ?  ? ? z-index: 97
   ?  Closing... (0.3s animation)?  ?
   ???????????????????????????????  ?
```

### Правила стека

1. **Новые сверху**: Каждый новый toast добавляется в начало
2. **Фиксированные отступы**: 0.75rem (12px) между toast
3. **Z-index порядок**: 100, 99, 98, 97, 96...
4. **Независимое закрытие**: Каждый toast закрывается через свой таймер

---

## Анимации

### 1. Появление (Slide In Right)

```
Frame 1: ???????????????????????????
(100% off-screen)        ??
         opacity: 0         ??
        ??
Frame 2: ???????????????????     ??
 (50% visible)     ?     ??
    opacity: 0.5      ?     ??
            ?     ??
Frame 3: ???????????????????     ??
         ? (fully visible) ?     ??
         ? opacity: 1      ?     ??
         ???????????????????     ??

Duration: 300ms
Easing: ease-out
```

### 2. Исчезновение (Slide Out Right)

```
Frame 1: ???????????????????     ??
         ? (fully visible) ?     ??
         ? scale: 1        ? ??
  ? opacity: 1      ?     ??
   ???????????????????     ??
         ??
Frame 2: ??????????????   ??
       (50% off)    ?        ??
   scale: 0.975 ?    ??
         opacity: 0.5 ?     ??
       ?          ??
Frame 3: ???????????????????????????
         (100% off-screen)        ??
         scale: 0.95    ??
    opacity: 0        ??

Duration: 300ms
Easing: ease-in
```

### 3. Hover эффект

```
Before Hover:
???????????????????
?  Toast    ?
?  transform: 0   ?
?  shadow: xl     ?
???????????????????

On Hover:
???????????????????   ? 2px up
?  Toast       ?   ? scale: 1.02
?  transform:     ?   ? shadow: 2xl
?  translateY(-2) ?
???????????????????

Duration: 200ms
Easing: ease
```

### 4. Progress Bar

```
Start (0s):
???????????????????????????????????? 100%

Middle (2.5s):
??????????????????????????????????? 50%

End (5s):
??????????????????????????????????? 0%

Animation: linear
Duration: 5000ms (configurable)
```

---

## Примеры кода

### Базовое использование

```typescript
import { NotificationComponent } from 'notification-component-mvp';

function App() {
  return (
    <NotificationComponent
      apiBaseUrl="http://localhost:5093/api"
      signalRHubUrl="http://localhost:5093/notificationHub"
      autoAuthenticate={true}
    />
  );
}
```

### Кастомная длительность

```typescript
// В Toast.tsx можно изменить duration prop
<Toast 
  notification={notification}
  onClose={handleClose}
  duration={3000} // 3 секунды вместо 5
/>
```

### Программное создание toast

```typescript
// Получить глобальную функцию
const showToast = (window as any).__showNotificationToast;

// Создать уведомление
if (showToast) {
  showToast({
    id: 'custom-id',
    type: 'Task',
    subType: 'Task Assigned',
    title: 'New Task',
    content: 'You have a new task',
 url: 'https://example.com/tasks/123',
    author: 'John Doe',
    hashtags: ['urgent', 'task', 'work'],
    date: new Date().toISOString(),
    read: false
  });
}
```

### Отключение toast при открытом dropdown

```typescript
// Автоматически обрабатывается в NotificationStore
private handleNewNotification(notification: Notification): void {
  // Toast показывается ТОЛЬКО если dropdown закрыт
  if (this.showToastCallback && !this.isDropdownOpen) {
  this.showToastCallback(notification);
  }
  
  // Но ВСЕГДА добавляется в store
  this.notifications.unshift(notification);
}
```

---

## Best Practices

### ? DO

1. **Закрывайте dropdown перед тестированием toast**
   ```typescript
   store.closeDropdown();
   // Теперь toast будут показываться
   ```

2. **Используйте осмысленные titles и content**
   ```typescript
   {
     title: "New Task Assigned",  // Кратко и понятно
     content: "Deploy feature X"   // Детали
   }
   ```

3. **Добавляйте hashtags для категоризации**
   ```typescript
   {
     hashtags: ['urgent', 'task', 'deploy']
   }
   ```

4. **Указывайте URL для кликабельности**
   ```typescript
   {
     url: 'https://app.com/tasks/123'  // Открывается в новой вкладке
   }
   ```

5. **Используйте type и subType**
   ```typescript
   {
   type: 'Task',        // Категория
     subType: 'Task Assigned' // Подкатегория
   }
   ```

### ? DON'T

1. **Не показывайте toast при открытом dropdown**
   - Автоматически обрабатывается
   - Пользователь уже видит уведомления

2. **Не делайте слишком длинный content**
   - Используется line-clamp-3
   - Текст обрежется

3. **Не используйте больше 3 hashtags**
   - Отображаются только первые 3
   - `slice(0, 3)`

4. **Не блокируйте UI**
   - Toast имеет `pointer-events-none` на контейнере
   - Только сам toast кликабельный

5. **Не забывайте про accessibility**
   - Используйте `role="alert"`
   - Добавьте `aria-live="polite"`

---

## Responsive дизайн

### Desktop (> 640px)
```
???????????????????????????????????
?  Toast (max-width: 24rem)       ?
?                 ?
???????????????????????????????????
```

### Mobile (< 640px)
```
???????????????????????????????????
?  Toast (full width - 2rem)      ?
?   ?
???????????????????????????????????
```

---

## Dark Mode

### Светлая тема
- Background: `bg-white`
- Border: `border-gray-200`
- Text: `text-gray-900`
- Progress: `bg-blue-500`

### Темная тема
- Background: `bg-gray-800`
- Border: `border-gray-700`
- Text: `text-white`
- Progress: `bg-blue-400`

---

## Заключение

Toast уведомления - это мощный инструмент для информирования пользователей о новых событиях в режиме реального времени. Следуйте этому руководству для создания красивых и функциональных уведомлений!

**Нужна помощь?** Посмотрите:
- [TOAST_NOTIFICATIONS.md](./TOAST_NOTIFICATIONS.md) - Техническая документация
- [TOAST_CHANGELOG.md](./TOAST_CHANGELOG.md) - История изменений
- [QUICK_START.md](./QUICK_START.md) - Быстрый старт

---

**Created by:** GitHub Copilot  
**Date:** 10 января 2025
